# Strength Training Guidance App 要件定義

## 1. プロダクト概要
- 目的: 科学的根拠に基づく高負荷マシントレーニングプロトコルを個人の状況に合わせて案内・記録する。
- 対象プラットフォーム: フロントエンドは Vercel 上の Next.js、バックエンドは Supabase。
- 利用スタイル: モバイルファーストの個人利用。セキュリティを重視し外部にデータを漏らさない。

## 2. 利用者ペルソナ
| ペルソナ | 特徴 | ゴール |
| --- | --- | --- |
| 初心者トレーニー | トレーニング歴6か月未満 | 正しいフォームと強度で安全に筋肥大を進めたい |
| 中級トレーニー | 6か月〜3年の経験、週4日以上 | RIR とボリュームを管理して停滞を打破したい |
| 自分自身 (個人利用) | ジムでのマシン利用が中心 | 科学的プロトコルを手軽に適用し、記録を残したい |

## 3. 機能要件
- 認証: Supabase Auth によるメール + パスワードログイン。プロフィール情報 (体重・経験年数など) を保持。
- メニュー生成: 週4日アッパー/ロワースプリットを基盤に、経験レベル・フォーカス部位・器具可用性で調整。RIR 1〜3、セット間 2〜3 分を明示。
- トレーニング記録: 各セットの重量・レップ・RIR・休憩時間を記録。セッション終了時に総ボリュームと推奨調整を表示。
- プログレッション管理: ダブルプログレッション法を実装し、レップ上限到達で重量増を提案。週あたりのボリュームと RIR 分布を可視化。
- デロード提案: 4〜8 週の負荷蓄積を監視し、ボリューム削減または強度削減オプションを提示。
- 通知/リマインド (後続): 未記録セッションやデロードタイミングを Supabase Functions で通知。

## 4. 非機能要件
- パフォーマンス: 初期ロード < 3 秒 (4G 回線想定)。Supabase API 応答 < 500ms (p95)。
- セキュリティ: Supabase RLS による行レベルセキュリティ、.env による秘密管理。
- 可用性: 99.5% 稼働 (Supabase SLA 基準)。週次でデータエクスポート。
- アクセシビリティ: WCAG 2.1 AA を目標。キーボード操作・スクリーンリーダー対応。

## 5. データ設計概要
- users: プロフィールと目標情報。
- training_templates: 自動生成メニュー。週番号・デロード推奨を含む。
- sessions: セッションヘッダー (日付・主観的疲労)。
- session_sets: セットごとの実績 (重量・レップ・RIR・休憩)。
- progress_metrics (集計テーブル): 週次のボリューム、RIR、重量推移をキャッシュ。

## 6. 外部連携
- Supabase Auth / Database / Storage / Edge Functions。
- (将来) Stripe による課金、SendGrid 等によるメール通知。

## 7. 技術スタック
- フロントエンド: Next.js (App Router), TypeScript, Tailwind CSS, Zustand。
- バックエンド: Supabase (Postgres + Auth + Functions)。
- インフラ: Vercel, Supabase。
- CI/CD: GitHub Actions → Vercel/Supabase 自動デプロイ。

## 8. 成功指標 (個人利用向け)
- 週次トレーニング記録率。
- RIR 適正範囲達成率。
- デロード実施率。

## 9. リスクと対策
| リスク | 影響 | 対策 |
| --- | --- | --- |
| RIR 自己評価の精度不足 | 推奨が不正確になる | 体感尺度チュートリアルと入力ガイドを提供 |
| 高ボリュームによる過負荷 | 怪我のリスク | デロード提案と疲労スコアの警告 |
| Supabase 依存 | ベンダーロック | 定期バックアップと抽象化レイヤ |

## 10. ロードマップ (初期)
1. MVP: 認証、メニュー生成、記録フォーム、進捗ダッシュボードの骨格。
2. Phase 2: 通知、デロード自動化、モバイル UI 最適化。
3. Phase 3: 高度な分析、外部連携 (トレーナー共有、課金など)。
